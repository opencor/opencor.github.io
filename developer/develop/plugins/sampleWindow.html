<!DOCTYPE html>
<html>
    <head>
        <title>
            Sample window
        </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>

        <link href="../../_static/pygments.css" rel="stylesheet" type="text/css" />
        <link href="../../_static/theme.css" rel="stylesheet" type="text/css" />

        <script src="../../_static/jquery.js" type="text/javascript"></script>
        <script src="../../_static/theme.js" type="text/javascript"></script>

        <link href="../../_static/katex/katex.min.css" rel="stylesheet" type="text/css"/>

        <script defer src="../../_static/katex/katex.min.js" type="text/javascript"></script>
        <script defer src="../../_static/katex/contrib/auto-render.min.js" type="text/javascript" onload="renderMathInElement(document.body);"></script>
    </head>
    <body ondragstart="return false;" ondrop="return false;">
        
  <div class="section" id="sample-window">
<span id="develop-plugins-samplewindow"></span><h1>Sample window<a class="headerlink" href="#sample-window" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this plugin is to extend our <a class="reference internal" href="sample.html#develop-plugins-sample"><span class="std std-ref">Sample</span></a> plugin by making it possible for the user to add two numbers through a dockable window.</p>
<div class="section" id="file-structure">
<h2>File structure<a class="headerlink" href="#file-structure" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>i18n
 └─ SampleWindow_fr.ts
res
 └─ SampleWindow_i18n.qrc.in
src
 ├─ samplewindowplugin.cpp
 ├─ samplewindowplugin.h
 ├─ samplewindowplugin.json
 ├─ samplewindowwindow.cpp
 ├─ samplewindowwindow.h
 └─ samplewindowwindow.ui
CMakeLists.txt
</pre></div>
</div>
</div>
<div class="section" id="category">
<h2>Category<a class="headerlink" href="#category" title="Permalink to this headline">¶</a></h2>
<p>Our plugin is part of the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/">Sample</a> category, which means that its code can be found under <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/sample/SampleWindow/</span></code></a>.</p>
</div>
<div class="section" id="interfaces">
<h2>Interfaces<a class="headerlink" href="#interfaces" title="Permalink to this headline">¶</a></h2>
<p>Unlike for the <a class="reference internal" href="sample.html#develop-plugins-sample"><span class="std std-ref">Sample</span></a> plugin, we want our plugin to interact with OpenCOR.
This means that it needs to implement some <a class="reference internal" href="index.html#develop-plugins-index-interfaces"><span class="std std-ref">interfaces</span></a>.</p>
<p>More specifically, we want our plugin to be a dockable window, so we need to implement both the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl">Plugin</a> and <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/windowinterface.inl">Window</a> interfaces.
While we are at it, we might also internationalise our plugin, which means also implementing the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.inl">Internationalisation</a> interface.</p>
</div>
<div class="section" id="cmake-project">
<h2>CMake project<a class="headerlink" href="#cmake-project" title="Permalink to this headline">¶</a></h2>
<p>As for the <a class="reference internal" href="sample.html#develop-plugins-sample"><span class="std std-ref">Sample</span></a> plugin, our plugin has a <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/CMakeLists.txt"><code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code></a> file, which contents is:</p>
<div class="highlight-cmake notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">project</span><span class="p">(</span><span class="s">SampleWindowPlugin</span><span class="p">)</span>

<span class="c"># Add the plugin</span>

<span class="nb">add_plugin</span><span class="p">(</span><span class="s">SampleWindow</span>
    <span class="s">SOURCES</span>
        <span class="s">../../i18ninterface.cpp</span>
        <span class="s">../../plugininfo.cpp</span>
        <span class="s">../../plugininterface.cpp</span>
        <span class="s">../../windowinterface.cpp</span>

        <span class="s">src/samplewindowplugin.cpp</span>
        <span class="s">src/samplewindowwindow.cpp</span>
    <span class="s">UIS</span>
        <span class="s">src/samplewindowwindow.ui</span>
    <span class="s">PLUGINS</span>
        <span class="s">Core</span>
        <span class="s">Sample</span>
<span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The interfaces our plugin implements come with a <code class="docutils literal notranslate"><span class="pre">.cpp</span></code> file, so we reference them (lines 7, 9 and 10).
Then, our plugin needs both the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> and <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/Sample/">Sample</a> plugins (the latter, to be able to use its <code class="docutils literal notranslate"><span class="pre">add()</span></code> function), so they are referenced (lines 17 and 18) using the <code class="docutils literal notranslate"><span class="pre">PLUGINS</span></code> keyword (line 16).
Our plugin comes with a dockable window, which is implemented using various files (lines 13 and 15).
One of those files is a <code class="docutils literal notranslate"><span class="pre">.ui</span></code> file, which is referenced using the <code class="docutils literal notranslate"><span class="pre">UIS</span></code> keyword (line 14).</p>
</div>
<div class="section" id="plugin-information">
<h2>Plugin information<a class="headerlink" href="#plugin-information" title="Permalink to this headline">¶</a></h2>
<p>Our <a class="reference internal" href="index.html#develop-plugins-index-plugininformation"><span class="std std-ref">plugin information</span></a> can be found in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp"><code class="docutils literal notranslate"><span class="pre">samplewindowplugin.cpp</span></code></a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.h"><code class="docutils literal notranslate"><span class="pre">samplewindowplugin.h</span></code></a> and <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.json"><code class="docutils literal notranslate"><span class="pre">samplewindowplugin.json</span></code></a>. Starting with <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.h"><code class="docutils literal notranslate"><span class="pre">samplewindowplugin.h</span></code></a>, its contents is:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;i18ninterface.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;plugininfo.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;plugininterface.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;windowinterface.h&quot;</span><span class="cp"></span>

<span class="c1">//==============================================================================</span>

<span class="k">namespace</span> <span class="n">OpenCOR</span> <span class="p">{</span>
<span class="k">namespace</span> <span class="n">SampleWindow</span> <span class="p">{</span>

<span class="c1">//==============================================================================</span>

<span class="n">PLUGININFO_FUNC</span> <span class="n">SampleWindowPluginInfo</span><span class="p">();</span>

<span class="c1">//==============================================================================</span>

<span class="k">class</span> <span class="nc">SampleWindowWindow</span><span class="p">;</span>

<span class="c1">//==============================================================================</span>

<span class="k">class</span> <span class="nc">SampleWindowPlugin</span> <span class="o">:</span> <span class="k">public</span> <span class="n">QObject</span><span class="p">,</span> <span class="k">public</span> <span class="n">I18nInterface</span><span class="p">,</span>
                           <span class="k">public</span> <span class="n">PluginInterface</span><span class="p">,</span> <span class="k">public</span> <span class="n">WindowInterface</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

    <span class="n">Q_PLUGIN_METADATA</span><span class="p">(</span><span class="n">IID</span> <span class="s">&quot;OpenCOR.SampleWindowPlugin&quot;</span> <span class="kt">FILE</span> <span class="s">&quot;samplewindowplugin.json&quot;</span><span class="p">)</span>

    <span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">I18nInterface</span><span class="p">)</span>
    <span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">PluginInterface</span><span class="p">)</span>
    <span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">WindowInterface</span><span class="p">)</span>

<span class="k">public</span><span class="o">:</span>
<span class="cp">#include</span> <span class="cpf">&quot;i18ninterface.inl&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;plugininterface.inl&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;windowinterface.inl&quot;</span><span class="cp"></span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">QAction</span> <span class="o">*</span><span class="n">mSampleWindowAction</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>

    <span class="n">SampleWindowWindow</span> <span class="o">*</span><span class="n">mSampleWindowWindow</span> <span class="o">=</span> <span class="k">nullptr</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">//==============================================================================</span>

<span class="p">}</span> <span class="c1">// namespace SampleWindow</span>
<span class="p">}</span> <span class="c1">// namespace OpenCOR</span>
</pre></div>
</td></tr></table></div>
<p>As mentioned above, our plugin implements some interfaces, which means that their header file is included (lines 28, 30 and 31).
It also means that our plugin class inherits from those interfaces (lines 48 and 49), as well as makes calls to the <code class="docutils literal notranslate"><span class="pre">Q_INTERFACES()</span></code> macro to let <a class="reference external" href="https://qt.io/">Qt</a> know which interfaces it implements (lines 55-57).
Finally, we include the inline files (lines 60-62) that declare various methods that must be implemented by our plugin (see <a class="reference internal" href="#develop-plugins-samplewindow-interfacesimplementation"><span class="std std-ref">below</span></a>).
(The rest of the class definition is specific to our plugin and is discussed <a class="reference internal" href="#develop-plugins-samplewindow-pluginspecific"><span class="std std-ref">below</span></a>.)</p>
<p>The C function that is used by OpenCOR to retrieve some <a class="reference internal" href="index.html#develop-plugins-index-basicinformation"><span class="std std-ref">basic information</span></a> about our plugin can be found in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp"><code class="docutils literal notranslate"><span class="pre">samplewindowplugin.cpp</span></code></a>:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>39
40
41
42
43
44
45
46
47
48
49</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">PLUGININFO_FUNC</span> <span class="nf">SampleWindowPluginInfo</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Descriptions</span> <span class="n">descriptions</span><span class="p">;</span>

    <span class="n">descriptions</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;en&quot;</span><span class="p">,</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromUtf8</span><span class="p">(</span><span class="s">&quot;a plugin that provides an addition window.&quot;</span><span class="p">));</span>
    <span class="n">descriptions</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="s">&quot;fr&quot;</span><span class="p">,</span> <span class="n">QString</span><span class="o">::</span><span class="n">fromUtf8</span><span class="p">(</span><span class="s">&quot;une extension qui fournit une fenêtre d&#39;addition.&quot;</span><span class="p">));</span>

    <span class="k">return</span> <span class="k">new</span> <span class="n">PluginInfo</span><span class="p">(</span><span class="n">PluginInfo</span><span class="o">::</span><span class="n">Category</span><span class="o">::</span><span class="n">Sample</span><span class="p">,</span> <span class="nb">true</span><span class="p">,</span> <span class="nb">false</span><span class="p">,</span>
                          <span class="p">{</span> <span class="s">&quot;Core&quot;</span><span class="p">,</span> <span class="s">&quot;Sample&quot;</span> <span class="p">},</span>
                          <span class="n">descriptions</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<p>As can be seen, our plugin is selectable by the user, but it does not offer <a class="reference external" href="https://en.wikipedia.org/wiki/Command-line_interface">CLI</a> support (line 46).
It also has a direct dependency on both the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> and <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/Sample/">Sample</a> plugins (line 47).</p>
</div>
<div class="section" id="interfaces-implementation">
<span id="develop-plugins-samplewindow-interfacesimplementation"></span><h2>Interfaces implementation<a class="headerlink" href="#interfaces-implementation" title="Permalink to this headline">¶</a></h2>
<p>The implementation of the interfaces’ various methods can be found in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowplugin.cpp"><code class="docutils literal notranslate"><span class="pre">samplewindowplugin.cpp</span></code></a>.
The methods are grouped by interface and are ordered alphabetically.</p>
<p>We start with the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.inl">Internationalisation</a> interface:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//==============================================================================</span>
<span class="c1">// I18n interface</span>
<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">retranslateUi</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Retranslate our Sample window action</span>

    <span class="n">retranslateAction</span><span class="p">(</span><span class="n">mSampleWindowAction</span><span class="p">,</span>
                      <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Sample&quot;</span><span class="p">),</span>
                      <span class="n">tr</span><span class="p">(</span><span class="s">&quot;Show/hide the Sample window&quot;</span><span class="p">));</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>
</pre></div>
</td></tr></table></div>
<p>All that we need to do is (re)translate <code class="docutils literal notranslate"><span class="pre">mSampleWindowAction</span></code> with the actual (French) translations in <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/SampleWindow/i18n/SampleWindow_fr.ts"><code class="docutils literal notranslate"><span class="pre">SampleWindow_fr.ts</span></code></a> (together with some other translations needed <a class="reference internal" href="#develop-plugins-samplewindow-pluginspecific"><span class="std std-ref">below</span></a>).</p>
<p>Next, we have the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl">Plugin</a> interface:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//==============================================================================</span>
<span class="c1">// Plugin interface</span>
<span class="c1">//==============================================================================</span>

<span class="kt">bool</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">definesPluginInterfaces</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// We don&#39;t handle this interface...</span>

    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">bool</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">pluginInterfacesOk</span><span class="p">(</span><span class="k">const</span> <span class="n">QString</span> <span class="o">&amp;</span><span class="n">pFileName</span><span class="p">,</span>
                                            <span class="n">QObject</span> <span class="o">*</span><span class="n">pInstance</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">pFileName</span><span class="p">)</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">pInstance</span><span class="p">)</span>

    <span class="c1">// We don&#39;t handle this interface...</span>

    <span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">initializePlugin</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Create an action to show/hide our Sample window</span>

    <span class="n">mSampleWindowAction</span> <span class="o">=</span> <span class="n">Core</span><span class="o">::</span><span class="n">newAction</span><span class="p">(</span><span class="nb">true</span><span class="p">,</span> <span class="n">Core</span><span class="o">::</span><span class="n">mainWindow</span><span class="p">());</span>

    <span class="c1">// Create our Sample window</span>

    <span class="n">mSampleWindowWindow</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SampleWindowWindow</span><span class="p">(</span><span class="n">Core</span><span class="o">::</span><span class="n">mainWindow</span><span class="p">());</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">finalizePlugin</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// We don&#39;t handle this interface...</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">pluginsInitialized</span><span class="p">(</span><span class="k">const</span> <span class="n">Plugins</span> <span class="o">&amp;</span><span class="n">pLoadedPlugins</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">pLoadedPlugins</span><span class="p">)</span>

    <span class="c1">// We don&#39;t handle this interface...</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">loadSettings</span><span class="p">(</span><span class="n">QSettings</span> <span class="o">&amp;</span><span class="n">pSettings</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">pSettings</span><span class="p">)</span>

    <span class="c1">// We don&#39;t handle this interface...</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">saveSettings</span><span class="p">(</span><span class="n">QSettings</span> <span class="o">&amp;</span><span class="n">pSettings</span><span class="p">)</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">pSettings</span><span class="p">)</span>

    <span class="c1">// We don&#39;t handle this interface...</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">handleUrl</span><span class="p">(</span><span class="k">const</span> <span class="n">QUrl</span> <span class="o">&amp;</span><span class="n">pUrl</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Q_UNUSED</span><span class="p">(</span><span class="n">pUrl</span><span class="p">)</span>

    <span class="c1">// We don&#39;t handle this interface...</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>
</pre></div>
</td></tr></table></div>
<p>The only method of interest to our plugin is <code class="docutils literal notranslate"><span class="pre">initializePlugin()</span></code> (lines 90-99), which is where we initialise both <code class="docutils literal notranslate"><span class="pre">mSampleWindowAction</span></code> and <code class="docutils literal notranslate"><span class="pre">mSampleWindowWindow</span></code>.
All the other methods (<code class="docutils literal notranslate"><span class="pre">definesPluginInterfaces()</span></code>, <code class="docutils literal notranslate"><span class="pre">pluginInterfacesOk()</span></code>, <code class="docutils literal notranslate"><span class="pre">finalizePlugin()</span></code>, <code class="docutils literal notranslate"><span class="pre">pluginsInitialized()</span></code>, <code class="docutils literal notranslate"><span class="pre">loadSettings()</span></code>, <code class="docutils literal notranslate"><span class="pre">saveSettings()</span></code> and <code class="docutils literal notranslate"><span class="pre">handleUrl()</span></code>) are left empty.</p>
<p>Finally, we have the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/windowinterface.inl">Window</a> interface:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1">//==============================================================================</span>
<span class="c1">// Window interface</span>
<span class="c1">//==============================================================================</span>

<span class="n">Qt</span><span class="o">::</span><span class="n">DockWidgetArea</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">windowDefaultDockArea</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="c1">// Return our default dock area</span>

    <span class="k">return</span> <span class="n">Qt</span><span class="o">::</span><span class="n">TopDockWidgetArea</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="n">QAction</span> <span class="o">*</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">windowAction</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="c1">// Return our window action</span>

    <span class="k">return</span> <span class="n">mSampleWindowAction</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="n">QDockWidget</span> <span class="o">*</span> <span class="n">SampleWindowPlugin</span><span class="o">::</span><span class="n">windowWidget</span><span class="p">()</span> <span class="k">const</span>
<span class="p">{</span>
    <span class="c1">// Return our window widget</span>

    <span class="k">return</span> <span class="n">mSampleWindowWindow</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>
</pre></div>
</td></tr></table></div>
<p>All three methods are implemented since they tell OpenCOR the default dock area for our plugin window (see <code class="docutils literal notranslate"><span class="pre">windowDefaultDockArea()</span></code>; lines 148-153), as well as provide the pointer to our action (see <code class="docutils literal notranslate"><span class="pre">windowAction()</span></code>; lines 157-162) and window (see <code class="docutils literal notranslate"><span class="pre">windowWidget()</span></code>; lines 166-171).</p>
</div>
<div class="section" id="plugin-specific">
<span id="develop-plugins-samplewindow-pluginspecific"></span><h2>Plugin specific<a class="headerlink" href="#plugin-specific" title="Permalink to this headline">¶</a></h2>
<p>Some extra work is needed to get our plugin to do what we want, and this is done via the <code class="docutils literal notranslate"><span class="pre">SampleWindowWindow</span></code> class in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.h"><code class="docutils literal notranslate"><span class="pre">samplewindowwindow.h</span></code></a>:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;windowwidget.h&quot;</span><span class="cp"></span>

<span class="c1">//==============================================================================</span>

<span class="k">namespace</span> <span class="n">Ui</span> <span class="p">{</span>
    <span class="k">class</span> <span class="nc">SampleWindowWindow</span><span class="p">;</span>
<span class="p">}</span> <span class="c1">// namespace Ui</span>

<span class="c1">//==============================================================================</span>

<span class="k">namespace</span> <span class="n">OpenCOR</span> <span class="p">{</span>
<span class="k">namespace</span> <span class="n">SampleWindow</span> <span class="p">{</span>

<span class="c1">//==============================================================================</span>

<span class="k">class</span> <span class="nc">SampleWindowWindow</span> <span class="o">:</span> <span class="k">public</span> <span class="n">Core</span><span class="o">::</span><span class="n">WindowWidget</span>
<span class="p">{</span>
    <span class="n">Q_OBJECT</span>

<span class="k">public</span><span class="o">:</span>
    <span class="k">explicit</span> <span class="n">SampleWindowWindow</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">pParent</span><span class="p">);</span>
    <span class="o">~</span><span class="n">SampleWindowWindow</span><span class="p">()</span> <span class="k">override</span><span class="p">;</span>

<span class="k">private</span><span class="o">:</span>
    <span class="n">Ui</span><span class="o">::</span><span class="n">SampleWindowWindow</span> <span class="o">*</span><span class="n">mGui</span><span class="p">;</span>

<span class="k">private</span> <span class="nl">slots</span><span class="p">:</span>
    <span class="kt">void</span> <span class="n">updateSum</span><span class="p">();</span>
<span class="p">};</span>

<span class="c1">//==============================================================================</span>

<span class="p">}</span> <span class="c1">// namespace SampleWindow</span>
<span class="p">}</span> <span class="c1">// namespace OpenCOR</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal notranslate"><span class="pre">SampleWindowWindow</span></code> inherits from <code class="docutils literal notranslate"><span class="pre">Core::WindowWidget</span></code>, which is defined in the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin and is an extended version of <a class="reference external" href="https://qt.io/">Qt</a>’s <code class="docutils literal notranslate"><span class="pre">QDockWidget</span></code> class (line 43).
It also comes with a GUI file, which describes the layout of our plugin window (<a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.ui"><code class="docutils literal notranslate"><span class="pre">samplewindowwindow.ui</span></code></a>).</p>
<p>The implementation of <code class="docutils literal notranslate"><span class="pre">SampleWindowWindow</span></code> can be found in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/sample/SampleWindow/src/samplewindowwindow.cpp"><code class="docutils literal notranslate"><span class="pre">samplewindowwindow.cpp</span></code></a>:</p>
<div class="highlight-c++ notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;sampleutilities.h&quot;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;samplewindowwindow.h&quot;</span><span class="cp"></span>

<span class="c1">//==============================================================================</span>

<span class="cp">#include</span> <span class="cpf">&quot;ui_samplewindowwindow.h&quot;</span><span class="cp"></span>

<span class="c1">//==============================================================================</span>

<span class="k">namespace</span> <span class="n">OpenCOR</span> <span class="p">{</span>
<span class="k">namespace</span> <span class="n">SampleWindow</span> <span class="p">{</span>

<span class="c1">//==============================================================================</span>

<span class="n">SampleWindowWindow</span><span class="o">::</span><span class="n">SampleWindowWindow</span><span class="p">(</span><span class="n">QWidget</span> <span class="o">*</span><span class="n">pParent</span><span class="p">)</span> <span class="o">:</span>
    <span class="n">Core</span><span class="o">::</span><span class="n">WindowWidget</span><span class="p">(</span><span class="n">pParent</span><span class="p">),</span>
    <span class="n">mGui</span><span class="p">(</span><span class="k">new</span> <span class="n">Ui</span><span class="o">::</span><span class="n">SampleWindowWindow</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1">// Set up the GUI</span>

    <span class="n">mGui</span><span class="o">-&gt;</span><span class="n">setupUi</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>

    <span class="c1">// A couple of connections to update our sum whenever one of the value of</span>
    <span class="c1">// one of our numbers is updated</span>

    <span class="n">connect</span><span class="p">(</span><span class="n">mGui</span><span class="o">-&gt;</span><span class="n">nb1DoubleSpinBox</span><span class="p">,</span> <span class="n">QOverload</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;::</span><span class="n">of</span><span class="p">(</span><span class="o">&amp;</span><span class="n">QDoubleSpinBox</span><span class="o">::</span><span class="n">valueChanged</span><span class="p">),</span>
            <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SampleWindowWindow</span><span class="o">::</span><span class="n">updateSum</span><span class="p">);</span>
    <span class="n">connect</span><span class="p">(</span><span class="n">mGui</span><span class="o">-&gt;</span><span class="n">nb2DoubleSpinBox</span><span class="p">,</span> <span class="n">QOverload</span><span class="o">&lt;</span><span class="kt">double</span><span class="o">&gt;::</span><span class="n">of</span><span class="p">(</span><span class="o">&amp;</span><span class="n">QDoubleSpinBox</span><span class="o">::</span><span class="n">valueChanged</span><span class="p">),</span>
            <span class="k">this</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">SampleWindowWindow</span><span class="o">::</span><span class="n">updateSum</span><span class="p">);</span>

    <span class="c1">// Initialise our sum</span>

    <span class="n">updateSum</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="n">SampleWindowWindow</span><span class="o">::~</span><span class="n">SampleWindowWindow</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Delete the GUI</span>

    <span class="k">delete</span> <span class="n">mGui</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="kt">void</span> <span class="n">SampleWindowWindow</span><span class="o">::</span><span class="n">updateSum</span><span class="p">()</span>
<span class="p">{</span>
    <span class="c1">// Update our sum</span>

    <span class="n">mGui</span><span class="o">-&gt;</span><span class="n">sumLabel</span><span class="o">-&gt;</span><span class="n">setText</span><span class="p">(</span><span class="n">QString</span><span class="o">::</span><span class="n">number</span><span class="p">(</span><span class="n">Sample</span><span class="o">::</span><span class="n">add</span><span class="p">(</span><span class="n">mGui</span><span class="o">-&gt;</span><span class="n">nb1DoubleSpinBox</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">(),</span> <span class="n">mGui</span><span class="o">-&gt;</span><span class="n">nb2DoubleSpinBox</span><span class="o">-&gt;</span><span class="n">value</span><span class="p">())));</span>
<span class="p">}</span>

<span class="c1">//==============================================================================</span>

<span class="p">}</span> <span class="c1">// namespace SampleWindow</span>
<span class="p">}</span> <span class="c1">// namespace OpenCOR</span>
</pre></div>
</td></tr></table></div>
<p><code class="docutils literal notranslate"><span class="pre">SampleWindowWindow()</span></code> (lines 38-57) initialises the <code class="docutils literal notranslate"><span class="pre">SampleWindowWindow</span></code> object, as well as creates a couple of connections (lines 49-52) and initialises our sum by calling <code class="docutils literal notranslate"><span class="pre">updateSum()</span></code> (line 56).
As can be seen, <code class="docutils literal notranslate"><span class="pre">updateSum()</span></code> calls the <code class="docutils literal notranslate"><span class="pre">add()</span></code> method from the <a class="reference internal" href="sample.html#develop-plugins-sample"><span class="std std-ref">Sample</span></a> plugin (lines 70-75).</p>
</div>
</div>



        <script type="text/javascript">
            copyright("../../_static");
        </script>
    </body>
</html>