<!DOCTYPE html>
<html>
    <head>
        <title>
            Plugins
        </title>

        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>

        <link href="../../_static/copybutton.css" rel="stylesheet" type="text/css" />
        <link href="../../_static/pygments.css" rel="stylesheet" type="text/css" />
        <link href="../../_static/tabs.css" rel="stylesheet" type="text/css" />
        <link href="../../_static/theme.css" rel="stylesheet" type="text/css" />
                <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
                <script src="../../_static/doctools.js?v=888ff710"></script>
                <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
                <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
                <script src="../../_static/copybutton.js?v=f281be69"></script>
                <script src="../../_static/tabs.js?v=3ee01567"></script>

        <script src="../../_static/theme.js" type="text/javascript"></script>

        <link href="../../_static/katex/katex.min.css" rel="stylesheet" type="text/css"/>

        <script defer src="../../_static/katex/katex.min.js" type="text/javascript"></script>
        <script defer src="../../_static/katex/contrib/auto-render.min.js" type="text/javascript" onload="renderMathInElement(document.body);"></script>
    </head>
    <body ondragstart="return false;" ondrop="return false;">
        
  <section id="plugins">
<span id="develop-plugins-index"></span><h1>Plugins<a class="headerlink" href="#plugins" title="Link to this heading">¶</a></h1>
<p>To help you get started, you might want to have a look at the following sample plugins.
They illustrate the basic concepts needed to develop plugins for OpenCOR:</p>
<ul class="simple">
<li><p><a class="reference internal" href="sample.html#develop-plugins-sample"><span class="std std-ref">Sample</span></a></p></li>
<li><p><a class="reference internal" href="sampleTools.html#develop-plugins-sampletools"><span class="std std-ref">Sample tools</span></a></p></li>
<li><p><a class="reference internal" href="sampleView.html#develop-plugins-sampleview"><span class="std std-ref">Sample view</span></a></p></li>
<li><p><a class="reference internal" href="sampleWindow.html#develop-plugins-samplewindow"><span class="std std-ref">Sample window</span></a></p></li>
</ul>
<p><strong>Note:</strong> these plugins only get built if the <code class="docutils literal notranslate"><span class="pre">ENABLE_SAMPLE_PLUGINS</span></code> option is set to <code class="docutils literal notranslate"><span class="pre">ON</span></code> in <a class="reference external" href="https://cmake.org/">CMake</a>.</p>
<section id="categories">
<span id="develop-plugins-index-categories"></span><h2>Categories<a class="headerlink" href="#categories" title="Link to this heading">¶</a></h2>
<p>All plugins come under one of the following categories:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/dataStore/"><strong>Data Store</strong></a>: plugins to store and manipulate data.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/editing/"><strong>Editing</strong></a>: plugins to edit files.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/"><strong>Miscellaneous</strong></a>: plugins that do not fit in any other category.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/organisation/"><strong>Organisation</strong></a>: plugins to organise files.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/"><strong>Sample</strong></a>: plugins that illustrate various plugin-related aspects.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/simulation/"><strong>Simulation</strong></a>: plugins to simulate files.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/solver/"><strong>Solver</strong></a>: plugins to access various solvers.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/support/"><strong>Support</strong></a>: plugins to support various third-party libraries.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/test/"><strong>Test</strong></a>: plugins to test things.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/thirdParty/"><strong>Third-party</strong></a>: plugins to access various third-party libraries.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/tools/"><strong>Tools</strong></a>: plugins to access various tools.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/widget/"><strong>Widget</strong></a>: plugins to access various <em>ad hoc</em> widgets.</p></li>
</ul>
<p>A category is used by OpenCOR to group plugins together to improve user experience.
From a developer’s perspective, a category determines where a plugin’s code should be located.
Thus, the different folders under <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/</span></code></a> are for our different categories.
For example, <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/miscellaneous/</span></code></a> contains the code of our different <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/">Miscellaneous</a> plugins and <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/miscellaneous/Core/</span></code></a> the code of our <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin in particular.</p>
<p><strong>Note:</strong> the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/sample/"><strong>Sample</strong></a> and <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/test/"><strong>Test</strong></a> categories are special categories that are only available when building OpenCOR with the <code class="docutils literal notranslate"><span class="pre">ENABLE_SAMPLE_PLUGINS</span></code> and <code class="docutils literal notranslate"><span class="pre">ENABLE_TEST_PLUGINS</span></code> options set to <code class="docutils literal notranslate"><span class="pre">ON</span></code>, respectively.
They should only be used for plugins that are aimed at helping people who want to learn how to write plugins for OpenCOR and at testing things, respectively.</p>
</section>
<section id="interfaces">
<span id="develop-plugins-index-interfaces"></span><h2>Interfaces<a class="headerlink" href="#interfaces" title="Link to this heading">¶</a></h2>
<p>Plugins can implement different interfaces.
Those interfaces allow a plugin, through the implementation of various methods, to interact with OpenCOR.
Current interfaces can be found under <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/</span></code></a>.
They are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/cliinterface.inl"><strong>CLI</strong></a>: to support command line execution.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/coreinterface.inl"><strong>Core</strong></a>: to control some of OpenCOR’s core aspects.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/datastoreinterface.inl"><strong>Data Store</strong></a>: to let OpenCOR know about the name of a data store, as well as retrieve some data from it and provide an instance of its exporter.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/filehandlinginterface.inl"><strong>File Handling</strong></a>: to save a file, as well as to be told when a file has been opened, modified, closed, etc.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/filetypeinterface.inl"><strong>File Type</strong></a>: to let OpenCOR know about supported file types and their description.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/guiinterface.inl"><strong>GUI</strong></a>: to let OpenCOR know about the menus and menu actions that we want to see added to the <a class="reference external" href="https://en.wikipedia.org/wiki/Graphical_user_interface">GUI</a>, as well as to be told when the <a class="reference external" href="https://en.wikipedia.org/wiki/Graphical_user_interface">GUI</a> needs updating.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.inl"><strong>Internationalisation</strong></a>: to be told when we should retranslate ourselves.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl"><strong>Plugin</strong></a>: to initialise/finalise a plugin, load/save its settings, etc.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/preferencesinterface.inl"><strong>Preferences</strong></a>: to specify a plugin’s default behaviour, settings, etc.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/pythoninterface.inl"><strong>Python</strong></a>: to register Python classes with OpenCOR.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/solverinterface.inl"><strong>Solver</strong></a>: to let OpenCOR know about the type, name, and properties of a solver, as well as to provide OpenCOR with an instance of that solver.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/viewinterface.inl"><strong>View</strong></a>: to let OpenCOR know about the name of a view, its mode, the MIME types it supports, whether we have a view for the current file, etc.</p></li>
<li><p><a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/windowinterface.inl"><strong>Window</strong></a>: to let OpenCOR know about the widget, action, and default location of a window.</p></li>
</ul>
<p>Some plugins do not implement any interface (e.g., the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/thirdParty/LLVMClang/">LLVM+Clang</a> plugin) while others may implement one or several interfaces (e.g., the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin implements the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/coreinterface.inl">Core</a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/filehandlinginterface.inl">File Handling</a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/guiinterface.inl">GUI</a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.inl">Internationalisation</a>, and <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl">Plugin</a> interfaces).</p>
<p><strong>Note:</strong> the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/coreinterface.inl">Core</a> interface is only, and can only be, implemented by the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin.
Any other plugin that tries to implement the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/coreinterface.inl">Core</a> interface will be reported by OpenCOR as being invalid.</p>
</section>
<section id="cmake-project">
<span id="develop-plugins-index-cmakeproject"></span><h2>CMake project<a class="headerlink" href="#cmake-project" title="Link to this heading">¶</a></h2>
<p>OpenCOR is built and packaged using <a class="reference external" href="https://cmake.org/">CMake</a>.
When it comes to plugins, this requires creating a <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> file in the plugin’s root folder and calling the <code class="docutils literal notranslate"><span class="pre">add_plugin()</span></code> macro, which is defined in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/cmake/common.cmake"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/cmake/common.cmake</span></code></a>.
That macro uses information passed to it to build and package the plugin.
That information comes in the form of a series of parameters, some of which are keywords:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SOURCES</span></code>: implementation files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UIS</span></code>: user interface files.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PLUGINS</span></code>: plugins needed by the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">QT_MODULES</span></code>: <a class="reference external" href="https://qt.io/">Qt</a> modules needed by the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTERNAL_BINARIES_DIR</span></code>: location of external binaries needed by the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTERNAL_BINARIES</span></code>: external binaries needed by the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTERNAL_DESTINATION_DIR</span></code>: location where external dependencies are to be copied.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTERNAL_SOURCE_DIR</span></code>: location of external dependencies.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SYSTEM_BINARIES</span></code>: system binaries needed by the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NO_STRIP</span></code>: whether we should not strip the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DEPENDS_ON</span></code>: <a class="reference external" href="https://cmake.org/">CMake</a> targets on which the plugin depends.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">BYPRODUCTS</span></code>: byproducts for the plugin.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TESTS</span></code>: <a class="reference internal" href="../tests.html#develop-tests"><span class="std std-ref">tests</span></a> for the plugin.</p></li>
</ul>
<p>Following those keywords are the parameters themselves, as can be seen in <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/miscellaneous/Core/CMakeLists.txt"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/miscellaneous/Core/CMakeLists.txt</span></code></a> for the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin.</p>
</section>
<section id="plugin-information">
<span id="develop-plugins-index-plugininformation"></span><h2>Plugin information<a class="headerlink" href="#plugin-information" title="Link to this heading">¶</a></h2>
<p>For a plugin to be recognisable by OpenCOR, it must provide some <a class="reference internal" href="#develop-plugins-index-basicinformation"><span class="std std-ref">basic information</span></a> about itself, as well as define a <a class="reference internal" href="#develop-plugins-index-pluginclass"><span class="std std-ref">plugin class</span></a>.
For this, we need a <code class="docutils literal notranslate"><span class="pre">.cpp</span></code>, a <code class="docutils literal notranslate"><span class="pre">.h</span></code>, and a <code class="docutils literal notranslate"><span class="pre">.json</span></code> file, such as <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/miscellaneous/Core/src/coreplugin.cpp"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/miscellaneous/Core/src/coreplugin.cpp</span></code></a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/miscellaneous/Core/src/coreplugin.h"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/miscellaneous/Core/src/coreplugin.h</span></code></a>, and <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/miscellaneous/Core/src/coreplugin.json"><code class="docutils literal notranslate"><span class="pre">[OpenCOR]/src/plugins/miscellaneous/Core/src/coreplugin.json</span></code></a> for the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin.</p>
<section id="json-file">
<span id="develop-plugins-index-jsonfile"></span><h3><code class="docutils literal notranslate"><span class="pre">.json</span></code> file<a class="headerlink" href="#json-file" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">.json</span></code> file is a simple <a class="reference external" href="https://json.org/json-en.html">JSON</a> file, which sole purpose is to reference the name of the plugin class.
In the case of the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin, the contents of that file is:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;Keys&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">&quot;CorePlugin&quot;</span><span class="w"> </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="namespace">
<h3>Namespace<a class="headerlink" href="#namespace" title="Link to this heading">¶</a></h3>
<p>The code for the <a class="reference internal" href="#develop-plugins-index-basicinformation"><span class="std std-ref">basic information</span></a> and <a class="reference internal" href="#develop-plugins-index-pluginclass"><span class="std std-ref">plugin class</span></a> must be in the plugin’s own namespace within the <code class="docutils literal notranslate"><span class="pre">OpenCOR</span></code> namespace.
More generally, any plugin-related code should be within those two namespaces, this to ensure the integrity of the plugin’s code.
Thus, in the case of the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin, we have:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">OpenCOR</span><span class="w"> </span><span class="p">{</span>
<span class="k">namespace</span><span class="w"> </span><span class="nn">Core</span><span class="w"> </span><span class="p">{</span>
<span class="p">...</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// namespace Core</span>
<span class="p">}</span><span class="w"> </span><span class="c1">// namespace OpenCOR</span>
<span class="p">...</span>
</pre></div>
</div>
</section>
<section id="basic-information">
<span id="develop-plugins-index-basicinformation"></span><h3>Basic information<a class="headerlink" href="#basic-information" title="Link to this heading">¶</a></h3>
<p>Plugins must provide the following basic information:</p>
<ul class="simple">
<li><p><strong>Category:</strong> category under which the plugin is to be listed.</p></li>
<li><p><strong>Selectable:</strong> whether the plugin can be selected by the user (for loading upon starting OpenCOR).</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Command-line_interface"><strong>CLI</strong></a> <strong>support:</strong> whether the plugin works from the command line.</p></li>
<li><p><strong>Dependencies:</strong> plugins on which the plugin depends directly.</p></li>
<li><p><strong>Descriptions:</strong> description of the plugin in various languages.</p></li>
<li><p><strong>Load before:</strong> plugins before which the plugin should be loaded.</p></li>
</ul>
<p>This information is made available to OpenCOR through a function, which in the case of the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin has the following declaration:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">PLUGININFO_FUNC</span><span class="w"> </span><span class="nf">CorePluginInfo</span><span class="p">();</span>
</pre></div>
</div>
<p><strong>Note:</strong> to ensure the uniqueness of a plugin, OpenCOR uses the name of a plugin to determine the name of its function.
In other words, the name of the function is expected to be <code class="docutils literal notranslate"><span class="pre">&lt;PluginName&gt;PluginInfo()</span></code>.
If it is not, OpenCOR will not recognise the plugin.</p>
<p>In the case of the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin, the body of that function is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">PLUGININFO_FUNC</span><span class="w"> </span><span class="nf">CorePluginInfo</span><span class="p">()</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">static</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">Descriptions</span><span class="w"> </span><span class="n">descriptions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                                 </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;en&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">QString</span><span class="o">::</span><span class="n">fromUtf8</span><span class="p">(</span><span class="s">&quot;the core plugin.&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">},</span>
<span class="w">                                                 </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;fr&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">QString</span><span class="o">::</span><span class="n">fromUtf8</span><span class="p">(</span><span class="s">&quot;l&#39;extension de base.&quot;</span><span class="p">)</span><span class="w"> </span><span class="p">}</span>
<span class="w">                                              </span><span class="p">};</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PluginInfo</span><span class="p">(</span><span class="n">PluginInfo</span><span class="o">::</span><span class="n">Category</span><span class="o">::</span><span class="n">Miscellaneous</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span><span class="w"> </span><span class="nb">false</span><span class="p">,</span>
<span class="w">                          </span><span class="p">{},</span>
<span class="w">                          </span><span class="n">descriptions</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Note:</strong> support for the internationalisation of a plugin’s description would normally be done using <a class="reference external" href="https://qt.io/">Qt</a>’s <code class="docutils literal notranslate"><span class="pre">tr()</span></code> function, but the C nature of the function means that it cannot be done.
So, instead, we use a <code class="docutils literal notranslate"><span class="pre">QMap</span></code>-based approach.</p>
</section>
<section id="plugin-class">
<span id="develop-plugins-index-pluginclass"></span><h3>Plugin class<a class="headerlink" href="#plugin-class" title="Link to this heading">¶</a></h3>
<p>We rely on <a class="reference external" href="https://qt.io/">Qt</a>’s support for plugins, which means that plugins must define a specific class.
The class must inherit from <code class="docutils literal notranslate"><span class="pre">QObject</span></code>, as well as from any interface the plugin implements.
For example, the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Core/">Core</a> plugin implements the <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/coreinterface.inl">Core</a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/filehandlinginterface.inl">File Handling</a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/guiinterface.inl">GUI</a>, <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/i18ninterface.inl">Internationalisation</a>, and <a class="reference external" href="https://github.com/opencor/opencor/blob/master/src/plugins/plugininterface.inl">Plugin</a> interfaces, so its class definition is:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CorePlugin</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">QObject</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">CoreInterface</span><span class="p">,</span>
<span class="w">                   </span><span class="k">public</span><span class="w"> </span><span class="n">FileHandlingInterface</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">GuiInterface</span><span class="p">,</span>
<span class="w">                   </span><span class="k">public</span><span class="w"> </span><span class="n">I18nInterface</span><span class="p">,</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">PluginInterface</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Q_OBJECT</span>

<span class="w">    </span><span class="n">Q_PLUGIN_METADATA</span><span class="p">(</span><span class="n">IID</span><span class="w"> </span><span class="s">&quot;OpenCOR.CorePlugin&quot;</span><span class="w"> </span><span class="kt">FILE</span><span class="w"> </span><span class="s">&quot;coreplugin.json&quot;</span><span class="p">)</span>

<span class="w">    </span><span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">CoreInterface</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">FileHandlingInterface</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">GuiInterface</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">I18nInterface</span><span class="p">)</span>
<span class="w">    </span><span class="n">Q_INTERFACES</span><span class="p">(</span><span class="n">OpenCOR</span><span class="o">::</span><span class="n">PluginInterface</span><span class="p">)</span>

<span class="k">public</span><span class="o">:</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;coreinterface.inl&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;filehandlinginterface.inl&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;guiinterface.inl&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;i18ninterface.inl&quot;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;plugininterface.inl&quot;</span>
<span class="p">...</span>
<span class="p">};</span>
<span class="p">...</span>
</pre></div>
</div>
<p>On the other hand, our <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/thirdParty/LLVMClang/">LLVM+Clang</a> plugin does not need to implement any interface since its sole purpose is to provide other plugins with access to <a class="reference external" href="https://llvm.org/">LLVM</a> and <a class="reference external" href="https://clang.llvm.org/">Clang</a>.
Hence, its much simpler class definition:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="k">class</span><span class="w"> </span><span class="nc">LLVMClangPlugin</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="k">public</span><span class="w"> </span><span class="n">QObject</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">Q_OBJECT</span>

<span class="w">    </span><span class="n">Q_PLUGIN_METADATA</span><span class="p">(</span><span class="n">IID</span><span class="w"> </span><span class="s">&quot;OpenCOR.LLVMClangPlugin&quot;</span><span class="w"> </span><span class="kt">FILE</span><span class="w"> </span><span class="s">&quot;llvmclangplugin.json&quot;</span><span class="p">)</span>
<span class="p">};</span>
<span class="p">...</span>
</pre></div>
</div>
</section>
<section id="global-header-file">
<span id="develop-plugins-index-globalheaderinformation"></span><h3>Global header file<a class="headerlink" href="#global-header-file" title="Link to this heading">¶</a></h3>
<p>There may be cases where a plugin declares a function or defines a class that we want to be able to use from another plugin.
On <a class="reference external" href="https://en.wikipedia.org/wiki/Linux">Linux</a> and <a class="reference external" href="https://en.wikipedia.org/wiki/MacOS">macOS</a>, nothing needs to be done about it, but on <a class="reference external" href="https://en.wikipedia.org/wiki/Microsoft_Windows">Windows</a>, the function or class needs to be exported by the original plugin:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">__declspec</span><span class="p">(</span><span class="n">dllexport</span><span class="p">)</span><span class="w"> </span><span class="n">myFunction</span><span class="p">();</span>
<span class="k">class</span><span class="w"> </span><span class="nc">__declspec</span><span class="p">(</span><span class="n">dllexport</span><span class="p">)</span><span class="w"> </span><span class="n">myClass</span><span class="p">;</span>
</pre></div>
</div>
<p>and imported by the plugin that wants to use it:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">__declspec</span><span class="p">(</span><span class="n">dllimport</span><span class="p">)</span><span class="w"> </span><span class="n">myFunction</span><span class="p">();</span>
<span class="k">class</span><span class="w"> </span><span class="nc">__declspec</span><span class="p">(</span><span class="n">dllimport</span><span class="p">)</span><span class="w"> </span><span class="n">myClass</span><span class="p">;</span>
</pre></div>
</div>
<p>Each plugin that exports functions and/or classes must therefore define a macro that refers either to <code class="docutils literal notranslate"><span class="pre">__declspec(dllexport)</span></code> or to <code class="docutils literal notranslate"><span class="pre">__declspec(dllimport)</span></code>, depending on how the plugin’s code is to be compiled.
In the case of the <a class="reference external" href="https://github.com/opencor/opencor/tree/master/src/plugins/miscellaneous/Compiler/">Compiler</a> plugin, we have:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">...</span>
<span class="cp">#ifdef Compiler_PLUGIN</span>
<span class="w">    </span><span class="cp">#define COMPILER_EXPORT Q_DECL_EXPORT</span>
<span class="cp">#else</span>
<span class="w">    </span><span class="cp">#define COMPILER_EXPORT Q_DECL_IMPORT</span>
<span class="cp">#endif</span>
<span class="p">...</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Compiler_PLUGIN</span></code> (or, more generally, <code class="docutils literal notranslate"><span class="pre">&lt;PluginName&gt;_PLUGIN</span></code>) is automatically defined, if at all, at build time, and is used to determine the value of <code class="docutils literal notranslate"><span class="pre">COMPILER_EXPORT</span></code> (or, more generally, the value of <code class="docutils literal notranslate"><span class="pre">&lt;PLUGINNAME&gt;_EXPORT</span></code>), which can then be used as follows without having to worry about whether the function or class should be imported or exported:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">COMPILER_EXPORT</span><span class="w"> </span><span class="nf">myFunction</span><span class="p">();</span>
<span class="k">class</span><span class="w"> </span><span class="nc">COMPILER_EXPORT</span><span class="w"> </span><span class="n">myClass</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
</section>



        <script type="text/javascript">
            copyright("../../_static");
        </script>
    </body>
</html>